<!DOCTYPE html>
<html lang="zh-Hant-TW">
  <head>
    <title>Samuel Meme</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <style>
      @media (min-width: 576px) {
        .card-columns {
          column-count: 2;
        }
      }

      @media (min-width: 768px) {
        .card-columns {
          column-count: 3;
        }
      }
    </style>
  </head>
  <body>
    <div class="container mt-4">
      <h1 class="text-center">Samuel Meme</h1>
      <div class="d-flex justify-content-center">
        <div class="spinner-border text-primary">
          <span class="sr-only">Loading...</span>
        </div>
      </div>
      <div id="cards" class="card-columns"></div>
    </div>

    <h2 class="error text-danger text-center" style="display: none;">Error QQ</h2>

    <template id="card">
      <div class="card p-3">
        <div class="card-body text-center">
          <h3 class="card-title"></h3>
        </div>
        <img class="card-img-top d-flex justify-content-center">
      </div>
    </template>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
    <script>
      fetch('/data.json')
        .then(res => res.json())
        .then(res => {
          const template = document.querySelector('#card')
          const cards = document.querySelector('#cards')

          res.data.forEach(file => {
            const node = template.cloneNode(true)

            const img = node.content.querySelector('img')
            img.src = encodeURIComponent(file)

            const title = node.content.querySelector('.card-title')
            title.innerText = file.replace(/\.(png|jpg|jpeg)/g, '')

            cards.appendChild(document.importNode(node.content, true))
          })
        })
        .catch(() => {
          document.querySelector('.error').style = ''
        })
        .finally(() => {
          document.querySelector('.spinner-border').style = 'display: none;'
        })
    </script>
  </body>
</html>
